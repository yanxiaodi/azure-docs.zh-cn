---
title: 为适用于 IoT 的 Azure 安全中心创建自定义警报 | Microsoft Docs
description: 为适用于 IoT 的 Azure 安全中心创建并分配自定义设备警报。
services: asc-for-iot
ms.service: asc-for-iot
documentationcenter: na
author: mlottner
manager: rkarlin
editor: ''
ms.assetid: d1757868-da3d-4453-803a-7e3a309c8ce8
ms.subservice: asc-for-iot
ms.devlang: na
ms.topic: quickstart
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/23/2019
ms.author: mlottner
ms.openlocfilehash: ed10cbf89f878f8d27b43476d26ac93dd373ed66
ms.sourcegitcommit: fe6b91c5f287078e4b4c7356e0fa597e78361abe
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/29/2019
ms.locfileid: "68597005"
---
# <a name="quickstart-create-custom-alerts"></a>快速入门：创建自定义警报


使用自定义安全组和警报，可以充分利用端到端的安全信息和分类设备知识来确保提高整个 IoT 解决方案的安全性。 

## <a name="why-use-custom-alerts"></a>为何要使用自定义警报？ 

可以最清楚地了解自己的 IoT 设备。

对于完全了解其预期设备行为的客户，适用于 IoT 的 Azure 安全中心可将这种了解转化为设备行为策略，并在背离预期的正常行为时发出警报。

## <a name="security-groups"></a>安全组

使用安全组可以定义设备的逻辑组，并集中管理设备的安全状态。

这些组可以表示具有特定硬件的设备、部署在某个位置的设备，或适合具体需求的其他任何组。

安全组由名为 **SecurityGroup** 的设备孪生标记属性定义。 默认情况下，IoT 中心内的每个 IoT 解决方案都有一个名为 **default** 的安全组。 更改 **SecurityGroup** 属性的值可以更改设备的安全组。
 
例如：

```
{
  "deviceId": "VM-Contoso12",
  "etag": "AAAAAAAAAAM=",
  "deviceEtag": "ODA1BzA5QjM2",
  "status": "enabled",
  "statusUpdateTime": "0001-01-01T00:00:00",
  "connectionState": "Disconnected",
  "lastActivityTime": "0001-01-01T00:00:00",
  "cloudToDeviceMessageCount": 0,
  "authenticationType": "sas",
  "x509Thumbprint": {
    "primaryThumbprint": null,
    "secondaryThumbprint": null
  },
  "version": 4,
  "tags": {
    "SecurityGroup": "default"
  }, 
```

使用安全组可将设备分组为逻辑类别。 创建组之后，请将其分配到所选的自定义警报，以最大程度地提高端到端 IoT 安全解决方案的效率。 

## <a name="customize-an-alert"></a>自定义警报

1. 打开 IoT 中心。 
2. 在“安全性”部分中单击“自定义警报”   。 
3. 选择要将自定义设置应用于的安全组。 
4. 单击“添加自定义警报”。 
5. 从下拉列表中选择自定义警报。 
6. 编辑所需的属性，然后单击“确定”。 
7. 请务必单击“保存”。  如果不保存新警报，下一次关闭 IoT 中心时会删除该警报。

 
## <a name="alerts-available-for-customization"></a>可自定义的警报

下表提供了可自定义的警报的摘要。


| 严重性 | Name | 数据源 | 说明 | 建议的补救措施|
|---|---|---|---|---|
| 低      | 自定义警报 - AMQP 协议中云到设备的消息数目超出了允许的范围          | IoT 中心     | 特定时间范围内的云到设备消息（AMQP 协议）数目超出了配置的允许范围。||
| 低      | 自定义警报 - AMQP 协议中已拒绝的云到设备的消息数目超出了允许的范围 | IoT 中心     | 设备在特定时间范围内拒绝的云到设备消息（AMQP 协议）数目超出了配置的允许范围。||
| 低      | 自定义警报 - AMQP 协议中设备到云的消息数目超出了允许的范围      | IoT 中心     | 特定时间范围内的设备到云消息（AMQP 协议）数量超出了配置的允许范围。|   |
| 低      | 自定义警报 - 直接方法调用数目超出了允许的范围 | IoT 中心     | 特定时间范围内的直接方法调用数量超出了当前配置的允许范围||
| 低      | 自定义警报 - 文件上传数目超出了允许的范围 | IoT 中心     | 特定时间范围内的文件上传数量超出了当前配置的允许范围| |
| 低      | 自定义警报 - HTTP 协议中云到设备的消息数目超出了允许的范围 | IoT 中心     | 时间窗口中云到设备的消息（HTTP 协议）数量不在配置的允许范围内                                  |
| 低      | 自定义警报 - HTTP 协议中已拒绝的云到设备的消息数目不在允许的范围内 | IoT 中心     | 特定时间范围内的云到设备消息（HTTP 协议）数量超出了配置的允许范围。 |
| 低      | 自定义警报 - HTTP 协议中设备到云的消息数目超出了允许的范围 | IoT 中心| 特定时间范围内的设备到云消息（HTTP 协议）数量超出了配置的允许范围。|    |
| 低      | 自定义警报 - MQTT 协议中云到设备的消息数目超出了允许的范围 | IoT 中心     | 特定时间范围内的云到设备消息（MQTT 协议）数量超出了配置的允许范围。|   |
| 低      | 自定义警报 - MQTT 协议中已拒绝的云到设备消息数目超出了允许的范围 | IoT 中心     | 设备在特定时间范围内拒绝的云到设备消息（MQTT 协议）数量超出了配置的允许范围。 |
| 低      | 自定义警报 - MQTT 协议中设备到云的消息数目超出了允许的范围          | IoT 中心     | 特定时间范围内的设备到云消息（MQTT 协议）数量超出了配置的允许范围。|
| 低      | 自定义警报 - 命令队列清除数目超出了允许的范围                               | IoT 中心     | 特定时间范围内的命令队列清除数量超出了当前配置的允许范围。||
| 低      | 自定义警报 - 模块孪生更新数目超出了允许的范围                                       | IoT 中心     | 特定时间范围内的模块孪生更新数量超出了当前配置的允许范围。|
| 低      | 自定义警报 - 未授权的操作数目超出了允许的范围  | IoT 中心     | 特定时间范围内的未授权操作数量超出了当前配置的允许范围。|
| 低      | 自定义警报 - 活动连接数目超出了允许的范围  | 代理       | 特定时间范围内的活动连接数目超出了当前配置的允许范围。|  调查设备日志。 了解连接的来源位置，并确定该连接是良性还是恶意的。 如果是恶意的，请删除可能的恶意软件并了解来源。 如果是良性的，请将来源添加到允许的连接列表。  |
| 低      | 自定义警报 - 与不允许的 IP 建立了出站连接                             | 代理       | 与允许的 IP 列表以外的 IP 建立了出站连接。 |调查设备日志。 了解连接的来源位置，并确定该连接是良性还是恶意的。 如果是恶意的，请删除可能的恶意软件并了解来源。 如果是良性的，请将来源添加到允许的 IP 列表。                        |
| 低      | 自定义警报 - 失败的本地登录次数超出了允许的范围                               | 代理       | 特定时间范围内的失败本地登录数量超出了当前配置的允许范围。 |   |
| 低      | 自定义警报 - 允许的用户列表以外的用户登录 | 代理       | 允许的用户列表以外的本地用户登录到了设备。|  如果你正在保存原始数据，请导航到 Log Analytics 帐户，并使用该数据调查设备，确定来源，然后修复这些设置的允许/阻止列表。 如果当前不是在保存原始数据，请转到设备，并修复这些设置的允许/阻止列表。|
| 低      | 自定义警报 - 执行了不允许的进程 | 代理       | 在设备上执行了某个不允许的进程。 |如果你正在保存原始数据，请导航到 Log Analytics 帐户，并使用该数据调查设备，确定来源，然后修复这些设置的允许/阻止列表。 如果当前不是在保存原始数据，请转到设备，并修复这些设置的允许/阻止列表。  |
|


## <a name="next-steps"></a>后续步骤

请转到下一篇文章了解如何部署安全代理...

> [!div class="nextstepaction"]
> [部署安全代理](how-to-deploy-agent.md)
