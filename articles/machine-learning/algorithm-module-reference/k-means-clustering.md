---
title: K 平均值聚类分析:模块参考
titleSuffix: Azure Machine Learning service
description: 了解如何在 Azure 机器学习服务中使用 K 平均值聚类分析模块来定型聚类分析模型。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: xiaoharper
ms.author: zhanxia
ms.date: 05/06/2019
ms.openlocfilehash: 7de2978fee80cf3acd078ef8ee5f235fab21713e
ms.sourcegitcommit: 07700392dd52071f31f0571ec847925e467d6795
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/28/2019
ms.locfileid: "70128707"
---
# <a name="module-k-means-clustering"></a>模块：K 平均值聚类

本文介绍如何在 Azure 机器学习 Studio 中使用*K 平均值聚类分析*模块来创建未经训练的 K 平均值聚类分析模型。 
 
K 平均值是最简单的*无人监督*学习算法之一。 可以将算法用于各种机器学习任务, 如: 

* [检测异常数据](https://msdn.microsoft.com/magazine/jj891054.aspx)。
* 对文本文档进行分类。
* 在使用其他分类或回归方法之前, 分析数据集。 

若要创建聚类分析模型, 请执行以下操作:

* 将此模块添加到试验中。
* 连接数据集。
* 设置参数, 例如所需的分类数, 要在创建群集时使用的距离度量值等。 
  
配置模块超参数后, 将未经训练的模型连接到[定型聚类分析模型](train-clustering-model.md)。 由于 K 平均值算法是无人监督学习方法, 因此标签列是可选的。 

+ 如果数据包含标签, 则可以使用标签值来指导选择分类并优化模型。 

+ 如果数据没有标签, 则算法会基于数据创建表示可能类别的分类。  

##  <a name="understand-k-means-clustering"></a>了解 K 平均值聚类
 
通常, 群集使用迭代技术将数据集中的事例分组到具有相似特征的分类。 这些分组有助于浏览数据、标识数据中的异常, 并最终用于进行预测。 聚类分析模型还可以帮助您识别数据集中的关系, 您可能不会通过浏览或简单的观察来以逻辑方式派生这些关系。 由于这些原因, 通常在机器学习任务的早期阶段使用聚类分析来浏览数据并发现意外的相关性。  
  
 使用 K 平均值方法配置聚类分析模型时, 必须指定目标数字*K* , 指示要在模型中使用的*质心*数。 质心是每个分类的代表点。 K 平均值算法将每个传入数据点分配给一个分类, 方法是最大程度地减少在群集内的平方和。 
 
当处理定型数据时, K 平均值算法以一组随机选择的初始质心开始。 质心充当群集的起点, 并应用 Lloyd 算法以迭代方式优化其位置。 当符合以下一个或多个条件时, K 平均值算法将停止构建和优化群集:  
  
-   质心稳定, 表示各个点的群集分配不再改变, 并且算法已聚合到解决方案中。  
  
-   该算法已运行完指定的迭代数。  
  
 完成培训阶段后, 可以使用 "[将数据分配到群集](assign-data-to-clusters.md)" 模块, 将新事例分配到使用 K 平均值算法找到的某个分类。 通过计算新事例与每个分类的质心之间的距离, 执行群集分配。 每个新事例分配给具有最接近质心的群集。  

## <a name="configure-the-k-means-clustering-module"></a>配置 K 平均值聚类分析模块
  
1.  向试验中添加**K 平均值聚类分析**模块。  
  
2.  若要指定模型的定型方式, 请选择 "**创建训练人员模式**" 选项。  
  
    -   **单个参数**:如果知道要在聚类分析模型中使用的确切参数, 可以提供一组特定的值作为参数。  
  
3.  对于 "**质心数**", 键入要开始算法的分类数。  
  
     此模型不能保证产生正好数量的群集。 该算法以此数目的数据点开始, 并循环访问以查找最佳配置。  
  
4.  属性**初始化**用于指定用于定义初始群集配置的算法。  
  
    -   **前 N**个:从数据集中选择了某些初始数目的数据点, 并将其用作初始方式。 
    
         此方法也称为*Forgy 方法*。  
  
    -   **随机**:该算法将数据点随机放置在群集中, 然后将初始平均值计算为分类的随机分配点的质心。 

         此方法也称为*随机分区*方法。  
  
    -   **K 平均值 + +** :这是用于初始化群集的默认方法。  
  
         **K 平均值 + +** 算法在2007中建议使用 Arthur 和 Sergei Vassilvitskii, 以避免标准 K 平均值算法的聚类分析。 **K 平均值 + +** 通过使用不同的方法选择初始群集中心来改善标准 K 平均值。  
  
    
5.  对于 "**随机数字种子**", 可以选择键入要用作群集初始化种子的值。 此值可能会对群集选择有重大影响。  
  
6.  对于 "**指标**", 请选择用于测量群集矢量之间或新数据点和随机所选质心之间的距离的函数。 Azure 机器学习支持以下群集距离度量值:  
  
    -   **欧氏**:对于 K 平均值聚类分析, 通常使用欧氏距离作为分类散播的度量。 此指标优先, 因为它最大程度地减少了点与质心之间的平均距离。
  
7.  对于 "**迭代**", 键入在完成选择质心之前算法应该循环访问定型数据的次数。  
  
     您可以调整此参数以平衡定型时间。  
  
8.  对于 "**分配标签模式**", 请选择一个选项, 该选项指定如何处理标签列 (如果它存在于数据集中)。  
  
     由于 K 平均值聚类分析是一种无人监督机器学习方法, 因此标签是可选的。 但是, 如果你的数据集已具有标签列, 则可以使用这些值来指导选择群集, 或者可以指定忽略这些值。  
  
    -   **忽略标签列**:"标签" 列中的值将被忽略, 并且不会在生成模型时使用。
  
    -   **填充缺失值**:标签列的值用作有助于构建群集的功能。 如果任何行缺少标签, 则使用其他功能数据估算值。  
  
    -   **从最接近中心覆盖**:使用最靠近当前质心的点的标签, 将标签列值替换为预测的标签值。  

8.  如果要在定型之前标准化功能, 请选择 "**规范化功能**" 选项。
  
     如果在定型之前应用规范化, 数据点将`[0,1]`按 MinMaxNormalizer 标准化。

10. 训练模型。  
  
    -   如果将 "**创建训练人员模式**" 设置为 "**单个参数**", 请添加标记数据集, 并使用 "[训练聚类模型](train-clustering-model.md)" 模块来训练该模型。  
  
### <a name="results"></a>结果

完成配置和定型模型后, 您可以使用一个模型来生成分数。 不过, 有多种方法来训练模型, 以及查看和使用结果的方式有多种: 

#### <a name="capture-a-snapshot-of-the-model-in-your-workspace"></a>捕获工作区中模型的快照

如果使用了 "[训练聚类模型](train-clustering-model.md)" 模块:

1. 右键单击 "**训练聚类模型**" 模块。

2. 选择 "**定型模型**", 然后选择 "**另存为定型模型**"。

保存的模型表示保存模型时的定型数据。 如果以后更新试验中使用的定型数据, 则不会更新已保存的模型。 

#### <a name="see-the-clustering-result-dataset"></a>查看聚类分析结果数据集 

如果使用了 "[训练聚类模型](train-clustering-model.md)" 模块:

1. 右键单击 "**训练聚类模型**" 模块。

2. 选择 "**结果数据集**", 然后选择 "**可视化**"。

### <a name="tips-for-generating-the-best-clustering-model"></a>有关生成最佳聚类分析模型的提示  

知道, 在聚类分析过程中使用的*种子设定*过程会显著影响模型。 种子设定指的是初始位置到潜在的质心。
 
例如, 如果数据集包含多个离群值, 并且选择了一个离群值以播种群集, 则没有其他数据点适合该群集, 并且群集可能是单一实例。 也就是说, 它可能只有一个点。  
  
可以通过以下几种方式来避免此问题:  
  
-   更改质心的数量, 并尝试多个种子值。  
  
-   创建多个模型, 改变指标或循环访问。  
  
通常, 对于聚类分析模型, 任何给定的配置都可能会导致本地优化群集集。 换句话说, 模型返回的一组分类只适合当前数据点, 而不能归纳为其他数据。 如果使用不同的初始配置, 则 K 平均值方法可能会发现不同的配置。 
